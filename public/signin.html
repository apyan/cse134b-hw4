<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Sign In</title>

    <link rel="stylesheet" type="text/css" href="stylesheet/amiiboTable.css">
    <link rel="stylesheet" type="text/css" href="stylesheet/buttonDesign.css">
    <link rel="stylesheet" type="text/css" href="stylesheet/divDesign.css">
    <link rel="stylesheet" type="text/css" href="stylesheet/textDesign.css">
    <script language="javascript" type="text/javascript" src="app.js"></script>

  </head>
  <body>

	<div>
		<button class="backButton" type="button" onclick="location.href='index.html'">Back</button>
		<h1 class="textLine_1">Sign In</h1>
		
		<form class="textLine_1">
	    	<!-- Username:<br>
	    	<input id="username" class="inputText" type="text" name="username">
	    	<br> -->
		E-Mail Address:<br>
	    	<input id="email" class="inputText" type="email" name="email">
	    	<br>
	    	Password:<br>
	    	<input id="password" class="inputText" type="password" name="password">
	    	<br><br>
	    	<!--change to submit-->
	    	<input id="sign-in" class="modButton" type="button" value="Sign In" onclick="signInUserData()">
		<br>
		<h3 class="textLine_1">- Or sign in with Google -</h3>
		<!-- Google Sign-In -->
		<input id="google-sign-in" class="googleButton" type="button" value=" " onclick="google_login_in()">
		</form>
		<br><p id="test"></p>
	</div>

  <script src="https://www.gstatic.com/firebasejs/3.7.0/firebase.js"></script>
  <script>
    // Initialize Firebase
    var config = {
      apiKey: "AIzaSyD3p9hdIYoCSi72wUMbPT-JkIzXPf6Xmrc",
      authDomain: "amiibodex.firebaseapp.com",
      databaseURL: "https://amiibodex.firebaseio.com",
      storageBucket: "amiibodex.appspot.com",
      messagingSenderId: "582801923363"
    };
    firebase.initializeApp(config);

    // Testing Sign-Up Button
    //var messagesRef = new Firebase('https://amiibodex.firebaseio.com/users');

	// Sign-In Button is pressed
	function signInUserData(){

		// Test Statements
		document.getElementById("test").innerHTML = "Creating user...";

		//var username = document.querySelector('#username').value;
		var email = document.querySelector('#email').value;
		var password = document.querySelector('#password').value;

		// Test Statements
		document.getElementById("test").innerHTML = password + " " + email;

		firebase.auth().signInWithEmailAndPassword(email, password).catch(function(error) {
   			console.log(error.code);
   			console.log(error.message);
		});

		var user = firebase.auth().currentUser;
		if(user) {
			document.getElementById("test").innerHTML = "TRUE: " + user.email;
			alert("Successfully signed in!" + user);
			window.location.href='indexsignedin.html';
		} else {
			document.getElementById("test").innerHTML = "FALSE: " + user.email;
		}

		// Re-direct to Signed-In Index (0.5 seconds)
		/*setTimeout(function(){
       			window.location='indexsignedin.html';
    		}, 500);*/
	}
  function google_login_in(){
        var provider = new firebase.auth.GoogleAuthProvider(); 
        provider.addScope('https://www.googleapis.com/auth/plus.login');
        firebase.auth().signInWithPopup(provider).then(function(result) {
            var token = result.credential.accessToken;
            var user = result.user;
        }).catch(function(error) {
            var errorCode     = error.code;
            var errorMessage  = error.message;
            var email         = error.email;
            var credential    = error.credential;
        });
        window.location.href = "indexsignedin.html";
    }
	// Google Login Button
	/*function googleSignIn() {
		document.getElementById("test").innerHTML = "GOOGLE";
		var provider = new firebase.auth.GoogleAuthProvider();
		provider.addScope('https://www.googleapis.com/auth/plus.login');
   		firebase.auth().signInWithPopup(provider).then(function(result) {
			var token = result.credential.accessToken;
			var user = result.user;
			console.log(token)
			console.log(user)
		}).catch(function(error) {
			var errorCode = error.code;
			var errorMessage = error.message;
			console.log(error.code)
			console.log(error.message)
		});
		document.getElementById("test").innerHTML = "GOOGLE: " + user.email;
	}*/

  </script>

  <script type="text/javascript" src="test.js"></script>
  </body>
</html>
